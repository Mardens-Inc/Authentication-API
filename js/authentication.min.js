/* Author: Drew Chase */
export default class Authentication{constructor(t=!1){this.apiUrl=t?"http://auth.local/":"https://auth.mardens.com/",this.debugMode=t;try{this.token=document.cookie.split(";").find(t=>t.trim().startsWith("token=")).trim().slice(6)}catch(t){this.token=null}if(!window.$)throw new Error("jQuery is required for this library to work.")}async login(t,e){return await $.ajax({url:this.apiUrl,method:"POST",dataType:"json",data:{username:t,password:e},success:t=>(t.success&&t.token&&this.generateCookies(t.token),t),error:t=>t})}async loginWithToken(t){return await $.ajax({url:this.apiUrl,method:"POST",dataType:"json",data:{token:t},success:e=>(e.success&&this.generateCookies(t),e),error:t=>t})}async loginWithTokenFromCookie(){return null!=this.token&&await this.loginWithToken(this.token)}logout(){document.cookie=`token=; path=/; domain=.${window.location.hostname}; samesite=strict; expires=Thu, 01 Jan 1970 00:00:00 GMT`}generateCookies(t){let e=new Date;e.setDate(e.getDate()+2),document.cookie=`token=${t}; path=/; domain=.${window.location.hostname}; samesite=strict; expires=${e.toGMTString()}`}}